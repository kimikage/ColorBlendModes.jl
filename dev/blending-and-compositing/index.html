<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Blending and Compositing · ColorBlendModes</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/mix.css" rel="stylesheet" type="text/css"/><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ColorBlendModes logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ColorBlendModes</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Blending and Compositing</a><ul class="internal"><li><a class="tocitem" href="#Types-for-specifying-modes"><span>Types for specifying modes</span></a></li><li><a class="tocitem" href="#Blending-and-compositing-function"><span>Blending and compositing function</span></a></li><li><a class="tocitem" href="#Calling-with-singleton-instances"><span>Calling with singleton instances</span></a></li><li><a class="tocitem" href="#Avoiding-name-clashes"><span>Avoiding name clashes</span></a></li></ul></li><li><a class="tocitem" href="../blend-modes/">Blend Modes</a></li><li><a class="tocitem" href="../composite-operations/">Composite Operations</a></li><li><a class="tocitem" href="../color-space-dependence/">Color Space Dependence</a></li><li><a class="tocitem" href="../utility-functions/">Utility Functions</a></li><li><a class="tocitem" href="../function-index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Blending and Compositing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Blending and Compositing</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kimikage/ColorBlendModes.jl/blob/master/docs/src/blending-and-compositing.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Blending-and-Compositing"><a class="docs-heading-anchor" href="#Blending-and-Compositing">Blending and Compositing</a><a id="Blending-and-Compositing-1"></a><a class="docs-heading-anchor-permalink" href="#Blending-and-Compositing" title="Permalink"></a></h1><h2 id="Types-for-specifying-modes"><a class="docs-heading-anchor" href="#Types-for-specifying-modes">Types for specifying modes</a><a id="Types-for-specifying-modes-1"></a><a class="docs-heading-anchor-permalink" href="#Types-for-specifying-modes" title="Permalink"></a></h2><p>ColorBlendModes defines two types for specifying modes: <a href="#ColorBlendModes.BlendModes.BlendMode"><code>BlendMode</code></a> for the mixing of opaque colors, and <a href="#ColorBlendModes.CompositeOperations.CompositeOperation"><code>CompositeOperation</code></a> for the generalized alpha compositing.</p><p>The users typically do not need to handle these types directly. Instead, the users can handle the predefined singleton instances of those types, e.g. <a href="../blend-modes/#multiply"><code>BlendMultiply</code></a>, <a href="../blend-modes/#screen"><code>BlendScreen</code></a> and <a href="../blend-modes/#overlay"><code>BlendOverlay</code></a> for <a href="#ColorBlendModes.BlendModes.BlendMode"><code>BlendMode</code></a>, or <a href="../composite-operations/#source-over"><code>CompositeSourceOver</code></a> and <a href="../composite-operations/#source-atop"><code>CompositeSourceAtop</code></a> for <a href="#ColorBlendModes.CompositeOperations.CompositeOperation"><code>CompositeOperation</code></a>. See <a href="../blend-modes/#Blend-Modes">Blend Modes</a> and <a href="../composite-operations/#Composite-Operations">Composite Operations</a> for all supported modes and their examples. Note that these predefined constants look like types, but are just instances.</p><article class="docstring"><header><a class="docstring-binding" id="ColorBlendModes.BlendModes.BlendMode" href="#ColorBlendModes.BlendModes.BlendMode"><code>ColorBlendModes.BlendModes.BlendMode</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BlendMode{mode}</code></pre><p>A type used for specifying the mixing mode of opaque colors. The <code>mode</code> should be a symbol.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kimikage/ColorBlendModes.jl/blob/b3ddacc92b94136ce8cdbcddcd4ba0d70947ae13/src/blendmodes.jl#L21-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ColorBlendModes.CompositeOperations.CompositeOperation" href="#ColorBlendModes.CompositeOperations.CompositeOperation"><code>ColorBlendModes.CompositeOperations.CompositeOperation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CompositeOperation{op}</code></pre><p>A type used for specifying the Porter-Duff operator, or the mode of generalized alpha compositing. The <code>op</code> should be a symbol.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kimikage/ColorBlendModes.jl/blob/b3ddacc92b94136ce8cdbcddcd4ba0d70947ae13/src/compositeoperations.jl#L18-L23">source</a></section></article><h2 id="Blending-and-compositing-function"><a class="docs-heading-anchor" href="#Blending-and-compositing-function">Blending and compositing function</a><a id="Blending-and-compositing-function-1"></a><a class="docs-heading-anchor-permalink" href="#Blending-and-compositing-function" title="Permalink"></a></h2><p>The <a href="#ColorBlendModes.blend"><code>blend</code></a> function creates the mixed color of two colors based on the specified blend mode and composite operation.</p><article class="docstring"><header><a class="docstring-binding" id="ColorBlendModes.blend" href="#ColorBlendModes.blend"><code>ColorBlendModes.blend</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">blend(c1, c2; mode=BlendNormal, opacity=1, op=CompositeSourceOver)</code></pre><p>Create the mixed color of two colors <code>c1</code> and <code>c2</code>. The <code>c1</code> means the backdrop color and the <code>c2</code> means the source color.</p><p><code>mode</code> specifies the blend mode, e.g. <a href="../blend-modes/#ColorBlendModes.BlendModes.BlendMultiply"><code>BlendMultiply</code></a>.</p><p><code>opacity</code> modifies the source (i.e. <code>c2</code>-side) alpha by multiplication.</p><p><code>op</code> specifies the composite operations, e.g. <a href="../composite-operations/#ColorBlendModes.CompositeOperations.CompositeSourceAtop"><code>CompositeSourceAtop</code></a>.</p><p>The return type is the same as <code>c1</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; blend(RGB(1, 0.5, 0), RGB(0, 0.5, 1), mode=BlendLighten)
RGB{Float64}(1.0,0.5,1.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kimikage/ColorBlendModes.jl/blob/b3ddacc92b94136ce8cdbcddcd4ba0d70947ae13/src/operations.jl#L129-L148">source</a></section></article><h3 id="Broadcasting"><a class="docs-heading-anchor" href="#Broadcasting">Broadcasting</a><a id="Broadcasting-1"></a><a class="docs-heading-anchor-permalink" href="#Broadcasting" title="Permalink"></a></h3><p>The <a href="#ColorBlendModes.blend"><code>blend</code></a> function is compatible with the broadcasting. Therefore, you can blend two images with the same size.</p><pre><code class="language-julia-repl hljs">julia&gt; image1 = [RGB(r, 1, b) for r=0:1, b=0:1]
2×2 Array{RGB{N0f8},2} with eltype RGB{N0f8}:
 RGB{N0f8}(0.0,1.0,0.0)  RGB{N0f8}(0.0,1.0,1.0)
 RGB{N0f8}(1.0,1.0,0.0)  RGB{N0f8}(1.0,1.0,1.0)

julia&gt; image2 = [RGB(r, g, 0) for g=0:1, r=0:1]
2×2 Array{RGB{N0f8},2} with eltype RGB{N0f8}:
 RGB{N0f8}(0.0,0.0,0.0)  RGB{N0f8}(1.0,0.0,0.0)
 RGB{N0f8}(0.0,1.0,0.0)  RGB{N0f8}(1.0,1.0,0.0)

julia&gt; blend.(image1, image2, mode=BlendMultiply)
2×2 Array{RGB{N0f8},2} with eltype RGB{N0f8}:
 RGB{N0f8}(0.0,0.0,0.0)  RGB{N0f8}(0.0,0.0,0.0)
 RGB{N0f8}(0.0,1.0,0.0)  RGB{N0f8}(1.0,1.0,0.0)</code></pre><p>Also, by using broadcast assignment (<code>.=</code>), you can do in-place blending, i.e. avoid allocating new arrays.</p><pre><code class="language-julia-repl hljs">julia&gt; buf = similar(image1); # allocate an output array in advance

julia&gt; buf .= blend.(image1, image2, mode=BlendLighten)
2×2 Array{RGB{N0f8},2} with eltype RGB{N0f8}:
 RGB{N0f8}(0.0,1.0,0.0)  RGB{N0f8}(1.0,1.0,1.0)
 RGB{N0f8}(1.0,1.0,0.0)  RGB{N0f8}(1.0,1.0,1.0)

julia&gt; @. buf = blend(buf, image2, mode=BlendDifference) # `@.` macro may be useful
2×2 Array{RGB{N0f8},2} with eltype RGB{N0f8}:
 RGB{N0f8}(0.0,1.0,0.0)  RGB{N0f8}(0.0,1.0,1.0)
 RGB{N0f8}(1.0,0.0,0.0)  RGB{N0f8}(0.0,0.0,1.0)</code></pre><h3 id="Opacity"><a class="docs-heading-anchor" href="#Opacity">Opacity</a><a id="Opacity-1"></a><a class="docs-heading-anchor-permalink" href="#Opacity" title="Permalink"></a></h3><p>The keyword argument <code>opacity</code> controls the alpha of source color <code>c2</code>. If <code>c2</code> is an opaque color, the <code>opacity</code> is used as the source alpha. If <code>c2</code> is a transparent color, <code>opacity * alpha(c2)</code> is used as the source alpha. The <code>opacity</code> is useful when used with broadcasting, i.e. the <code>opacity</code> acts as so-called &quot;layer opacity&quot;.</p><p>The following are examples where an image of green triangles (<code>image_green</code>) is layered on an image of blue triangles (<code>image_blue</code>).</p><pre><code class="language-julia hljs">image_green = load(&quot;green.png&quot;)
image_blue  = load(&quot;blue.png&quot;)

for mode in (BlendNormal, BlendMultiply, BlendScreen)
    for opacity in (25, 50, 75, 100)
        out = blend.(image_blue, image_green, mode=mode, opacity=opacity/100)
        save(keyword(mode) * &quot;_&quot; * string(opacity) * &quot;.png&quot;, out)
    end
end</code></pre><table><tr><th style="text-align: center">blend mode</th><th style="text-align: center"><code>opacity=0.25</code></th><th style="text-align: center"><code>opacity=0.5</code></th><th style="text-align: center"><code>opacity=0.75</code></th><th style="text-align: center"><code>opacity=1.0</code> (default)</th></tr><tr><td style="text-align: center">normal</td><td style="text-align: center"><img src="../assets/normal_25.png" alt="normal25%"/></td><td style="text-align: center"><img src="../assets/normal_50.png" alt="normal50%"/></td><td style="text-align: center"><img src="../assets/normal_75.png" alt="normal75%"/></td><td style="text-align: center"><img src="../assets/normal_100.png" alt="normal100%"/></td></tr><tr><td style="text-align: center">multiply</td><td style="text-align: center"><img src="../assets/multiply_25.png" alt="multiply25%"/></td><td style="text-align: center"><img src="../assets/multiply_50.png" alt="multiply50%"/></td><td style="text-align: center"><img src="../assets/multiply_75.png" alt="multiply75%"/></td><td style="text-align: center"><img src="../assets/multiply_100.png" alt="multiply100%"/></td></tr><tr><td style="text-align: center">screen</td><td style="text-align: center"><img src="../assets/screen_25.png" alt="screen25%"/></td><td style="text-align: center"><img src="../assets/screen_50.png" alt="screen50%"/></td><td style="text-align: center"><img src="../assets/screen_75.png" alt="screen75%"/></td><td style="text-align: center"><img src="../assets/screen_100.png" alt="screen100%"/></td></tr></table><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The <code>opacity</code> is typically specified in the range [0,1]. A value out of the range can be specified, but the <a href="#ColorBlendModes.blend"><code>blend</code></a> function does not clip the intermediate values. Therefore an arbitrary color may be returned.</p></div></div><h2 id="Calling-with-singleton-instances"><a class="docs-heading-anchor" href="#Calling-with-singleton-instances">Calling with singleton instances</a><a id="Calling-with-singleton-instances-1"></a><a class="docs-heading-anchor-permalink" href="#Calling-with-singleton-instances" title="Permalink"></a></h2><p>For convenience, the instances of <a href="#ColorBlendModes.BlendModes.BlendMode"><code>BlendMode</code></a> and <a href="#ColorBlendModes.CompositeOperations.CompositeOperation"><code>CompositeOperation</code></a> are callable. They are equivalent to the <a href="#ColorBlendModes.blend"><code>blend</code></a> function, with the instance assigned to the keyword argument <code>mode</code> or <code>op</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; c1 = RGBA(1, 0.5, 0, 0.5); c2 = RGB(0, 0.5, 1);

julia&gt; BlendMultiply(c1, c2) === blend(c1, c2, mode=BlendMultiply)
true

julia&gt; CompositeSourceOver(c1, c2) === blend(c1, c2, op=CompositeSourceOver)
true

julia&gt; BlendDarken(c1, c2, opacity=0.25, op=CompositeSourceAtop)
RGBA{Float64}(0.75,0.5,0.125,0.5)

julia&gt; CompositeSourceAtop(c1, c2, opacity=0.25, mode=BlendDarken)
RGBA{Float64}(0.75,0.5,0.125,0.5)</code></pre><p>However, it is not recommended to call the predefined constants directly, e.g. <code>BlendMultiply(c1, c2)</code>. They are should be called via method arguments or local variables.</p><h2 id="Avoiding-name-clashes"><a class="docs-heading-anchor" href="#Avoiding-name-clashes">Avoiding name clashes</a><a id="Avoiding-name-clashes-1"></a><a class="docs-heading-anchor-permalink" href="#Avoiding-name-clashes" title="Permalink"></a></h2><p>The main function of this package, <a href="#ColorBlendModes.blend"><code>blend</code></a>, is a generic word and is therefore at risk of name clashes. The <a href="#ColorBlendModes.BlendModes.BlendMode"><code>BlendMode</code></a>, <a href="#ColorBlendModes.CompositeOperations.CompositeOperation"><code>CompositeOperation</code></a> and their singleton instances are defined in sub-modules called <code>BlendModes</code> and <code>CompositeOperations</code>, and hence you can introduce the set of definitions optionally. Note the presence of the plural <code>s</code> at the end.</p><pre><code class="language-julia-repl hljs">julia&gt; blend(a, b) = (a + b) / 2;

julia&gt; using ColorTypes;

julia&gt; import ColorBlendModes; # instead of `using`

julia&gt; using ColorBlendModes.BlendModes, ColorBlendModes.CompositeOperations;

julia&gt; blend(0, 1) # does not clash
0.5

julia&gt; ColorBlendModes.blend(Gray(1), Gray(0), mode=BlendLighten, op=CompositeSourceOver)
Gray{N0f8}(1.0)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../blend-modes/">Blend Modes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.6 on <span class="colophon-date" title="Thursday 9 September 2021 08:39">Thursday 9 September 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
